var Stats=function(){var e,t={},r=function(t,r){for(var n,o=e,a=r||{},s=a.from||0,i=a.to||e.length-1;s<=i;){if(o[n=parseInt((s+i)/2)]===t)return n;o[n]<t?s=n+1:i=n-1}return a.allowSuccessor?o[n]>t?n:n+1<o.length?n+1:-1:a.allowPredecessor?o[n]<t?n:n-1>=0?n-1:-1:-1},n=function(t){var n={};n[t.id]=JSON.stringify(t);var o=Storage.set(n);if(-1===r(t.id)){e.push(t.id);var a=Storage.set({statsIds:e})}return Promise.all([o,a])},o=function(r){for(var n=0;n<r.length;n++)delete t[r[n]];return e=e.filter((function(e){return-1===r.indexOf(e)})),Storage.set({statsIds:e}).then((function(){return Storage.remove(r,"local")}))};return{init:function(t){e=t||[],function(){var t=new Date(Date.now()-16416e6),r=new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime().toString(),n=e.filter((e=>e<r));o(n)}()},factory:function(){var e={};e.id=Date.now().toString(),e.workLength=0,e.breakLength=0,e.longerBreakLength=0,e.serie=0,e.pauses=0,e.blockedFrequency=[],e.blockedUrls=[],e.workCycles=0,e.breakCycles=0,e.skippedBreaks=0,e.skippedLongBreaks=0,e.totalWorkTime=0,e.totalPauseTime=0,e.totalBreakTime=0,e.startTime=0;var t=new Date,r=100*t.getFullYear();return r=100*((r=100*((r=100*((r=100*(r+t.getMonth()+1))+t.getDate()))+t.getHours()))+t.getMinutes()),r+=t.getSeconds(),e.yyyymmddhhmmss=r,e},save:n,set:function(e,r,o,a){if(arguments.length<3)!function(e,r){if("object"==typeof e&&"object"==typeof r){for(var o=Object.keys(r),a=0;a<o.length;a++){var s=o[a],i=r[s];if(void 0===e[s])return;if("object"==typeof i&&!Array.isArray(i)||"function"==typeof i||void 0===i)return;e[s]=i}t[e.id]=e,n(e)}}(e,r);else{var s=r;"object"==typeof e&&("object"==typeof o&&!Array.isArray(o)||"function"==typeof o||void 0===o||void 0!==e[s]&&(e[s]=o,t[e.id]=e,a||n(e)))}},removeItems:o,removeAllItems:function(){return t={},e=[],Storage.set({statsIds:e}).then((function(){return Storage.remove(e,"local")}))},addBlockedURL:function(e,t){for(var r,n=e.blockedUrls,o=e.blockedFrequency,a=0;a<n.length;a++)if(n[a]===t){o[a]++,r=a;break}a===n.length&&(n.push(t),o.push(1),r=a);var s=o[r],i=n[r];if(r===n.length-1){for(a=r;a>0&&(o[a-1]>s||o[a-1]===s&&n[a-1]>i);)o[a]=o[a-1],n[a]=n[a-1],a--;o[a]=s,n[a]=i}else{for(a=r;a<n.length-1&&(o[a+1]<s||o[a+1]===s&&n[a+1]<i);)o[a]=o[a+1],n[a]=n[a+1],a++;o[a]=s,n[a]=i}},getLocalDateParts:function(e){var t=e-100*parseInt(e/100),r=parseInt(e/100),n=r-100*parseInt(r/100),o=parseInt(r/100),a=o-100*parseInt(o/100),s=parseInt(o/100),i=s-100*parseInt(s/100),u=parseInt(s/100),f=u-100*parseInt(u/100);return[parseInt(u/100),f,i,a,n,t]},getByLastDays:function(n){var o=24*n*60*60*1e3,a=new Date(Date.now()-o),s=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime().toString(),i=r(s,{allowSuccessor:!0});if(i>=0){for(var u=[],f=i;f<e.length;f++)u.push(e[f]);return function(e){var r=[],n=e.filter((function(e){return!t[e]||(r.push(t[e]),!1)}));return Storage.get(n).then((function(e){for(var n=Object.keys(e),o=0;o<n.length;o++){var a=n[o],s=JSON.parse(e[a]);r.push(s),t[a]=s}return r}))}(u).then((function(e){return e.sort((function(e,t){return e.startTime-t.startTime})),e}))}return Promise.resolve([])}}}();